<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tetrsi hecho en java script</title>

    <link rel="stylesheet" href="./styles/styles.css">
    <!--se importa libreria de p5.js para poder manejar mejor el canvas-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js"></script>
    <scrip src="./scripts/tetris.js"></scrip>
</head>
<body>

    <div class="titulo">
        <h1 id="letrat">T</h1>
        <h1 id="letrae">E</h1>
        <h1 id="letrat2">T</h1>
        <h1 id="letrar">R</h1>
        <h1 id="letrai">I</h1>
        <h1 id="letras">S</h1>
    </div>
    <script src="./scripts/Tablerotetris.js"></script>
    <!--se hace un pequeño script dentro del html 
    por que se esta trabajando con una liberia por lo tanto 
    se define desde acá la parte del canvas donde se dibujrá 
    cada celda -->

    <script>

        const margen_tablero = 10
        let regulador_velocidad_teclas = 0

    /* tanto la función setup como draw, con nativas de p5.js 
    esa es una de las ventajas de esta liberia, sirve para 
    ajustar las propiedades iniciales de los objetos y variables*/

    function setup(){
        createCanvas(900,600)
        tablero = new Tablero()
        tetromino = new Tetrimino()
        resizeCanvas(tablero.ancho + 2 * margen_tablero,tablero.alto + 2 * margen_tablero)
    }

    /* la función draw sirve para dar instrucciones especificas 
    de dibujo como el color*/

    function draw(){
        background("#17FCF9")
        tablero.dibujar()
        tetromino.dibujar()
        keyEventsTetris()
    }

    function keyEventsTetris(){
        if(millis() - regulador_velocidad_teclas < 100 ){
            return
        }
        regulador_velocidad_teclas = millis() 
        if(keyIsDown(RIGHT_ARROW)){
            tetromino.moverDerecha()
        }
        if(keyIsDown(LEFT_ARROW)){
            tetromino.moverIzquierda()
        }
        if(keyIsDown(DOWN_ARROW)){
            tetromino.moverAbajo()
        }
        if(keyIsDown(UP_ARROW)){
            tetromino.moverArriba()
        }
    }

    /*se define una clase para el tetrimino y se le dice 
    que comience a dibujar desde la cordenada 0,0 del 
    origen del tablero, no del canvas*/

    class Tetrimino{
        constructor(){
            this.posicion = createVector(0, 0)
        }

        moverDerecha(){
            this.posicion.x++
        }

        moverIzquierda(){
            this.posicion.x--
        }

        moverAbajo(){
            this.posicion.y++
        }

        moverArriba(){
            this.posicion.y--
        }
        /*esta funcion se encarga del procesamiento del 
        tetrimino*/

        dibujar(){
            push()
            fill("red")
            let coord = tablero.coordenada(this.posicion.x, this.posicion.y)
            rect(coord.x,coord.y,tablero.lado_celda)
            pop()
        }
    }

    </script>

</body>
</html>